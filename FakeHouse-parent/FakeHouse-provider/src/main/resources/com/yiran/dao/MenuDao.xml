<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yiran.dao.MenuDao" >


    <!--  通过用户名查询出用户的头菜单  -->
    <!--  按照菜单表中的priority进行排序  -->
    <select id="findTopMenuByUsername" parameterType="string" resultType="com.yiran.pojo.Menu">
        SELECT m.*
        FROM t_role r, t_menu m,t_role_menu rm, t_user u, t_user_role ur
        WHERE u.username = #{value} AND u.id = ur.user_id AND ur.role_id = r.id AND r.id = rm.role_id AND rm.menu_id = m.id AND m.level = 1
        ORDER BY m.priority asc
    </select>


    <!--   通过父菜单的id查询 -->
    <select id="findChildrenByMenuId" parameterType="int" resultType="com.yiran.pojo.Menu">
        SELECT *
        FROM  t_menu m
        WHERE m.parentMenuId = #{value}
        ORDER BY m.priority ASC
    </select>



</mapper>